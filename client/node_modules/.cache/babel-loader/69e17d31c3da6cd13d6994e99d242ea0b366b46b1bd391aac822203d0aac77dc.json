{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"./ProductsPage.css\";import ProductsList from\"../../components/ProductsList\";import ProductModal from\"../../components/ProductModal\";import{api}from\"../../api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ProductsPage(){const[products,setProducts]=useState([]);const[loading,setLoading]=useState(true);const[modalOpen,setModalOpen]=useState(false);const[modalMode,setModalMode]=useState(\"create\");const[editingProduct,setEditingProduct]=useState(null);useEffect(()=>{loadProducts();},[]);const loadProducts=async()=>{try{setLoading(true);const data=await api.getProducts();setProducts(data);}catch(err){console.error(err);alert(\"Ошибка загрузки товаров\");}finally{setLoading(false);}};const openCreate=()=>{setModalMode(\"create\");setEditingProduct(null);setModalOpen(true);};const openEdit=product=>{setModalMode(\"edit\");setEditingProduct(product);setModalOpen(true);};const closeModal=()=>{setModalOpen(false);setEditingProduct(null);};const handleDelete=async id=>{const ok=window.confirm(\"Удалить товар?\");if(!ok)return;try{await api.deleteProduct(id);setProducts(prev=>prev.filter(p=>p.id!==id));}catch(err){console.error(err);alert(\"Ошибка удаления товара\");}};const handleSubmitModal=async payload=>{try{if(modalMode===\"create\"){const newProduct=await api.createProduct(payload);setProducts(prev=>[...prev,newProduct]);}else{const updatedProduct=await api.updateProduct(payload.id,payload);setProducts(prev=>prev.map(p=>p.id===payload.id?updatedProduct:p));}closeModal();}catch(err){console.error(err);alert(\"Ошибка сохранения товара\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header__inner\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"brand\",children:\"\\u041C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D \\u044D\\u043B\\u0435\\u043A\\u0442\\u0440\\u043E\\u043D\\u0438\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header__right\",children:\"React\"})]})}),/*#__PURE__*/_jsx(\"main\",{className:\"main\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"\\u0422\\u043E\\u0432\\u0430\\u0440\\u044B\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn--primary\",onClick:openCreate,children:\"+ \\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})]}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"empty\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):/*#__PURE__*/_jsx(ProductsList,{products:products,onEdit:openEdit,onDelete:handleDelete})]})}),/*#__PURE__*/_jsx(\"footer\",{className:\"footer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"footer__inner\",children:[\"\\xA9 \",new Date().getFullYear(),\" \\u041C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D \\u044D\\u043B\\u0435\\u043A\\u0442\\u0440\\u043E\\u043D\\u0438\\u043A\\u0438\"]})}),/*#__PURE__*/_jsx(ProductModal,{open:modalOpen,mode:modalMode,initialProduct:editingProduct,onClose:closeModal,onSubmit:handleSubmitModal})]});}","map":{"version":3,"names":["React","useEffect","useState","ProductsList","ProductModal","api","jsx","_jsx","jsxs","_jsxs","ProductsPage","products","setProducts","loading","setLoading","modalOpen","setModalOpen","modalMode","setModalMode","editingProduct","setEditingProduct","loadProducts","data","getProducts","err","console","error","alert","openCreate","openEdit","product","closeModal","handleDelete","id","ok","window","confirm","deleteProduct","prev","filter","p","handleSubmitModal","payload","newProduct","createProduct","updatedProduct","updateProduct","map","className","children","onClick","onEdit","onDelete","Date","getFullYear","open","mode","initialProduct","onClose","onSubmit"],"sources":["/Users/artemfarniev2013/WebstormProjects/untitled14/client/src/pages/ProductsPage/ProductsPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./ProductsPage.css\";\nimport ProductsList from \"../../components/ProductsList\";\nimport ProductModal from \"../../components/ProductModal\";\nimport { api } from \"../../api\";\n\nexport default function ProductsPage() {\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [modalMode, setModalMode] = useState(\"create\");\n  const [editingProduct, setEditingProduct] = useState(null);\n\n  useEffect(() => {\n    loadProducts();\n  }, []);\n\n  const loadProducts = async () => {\n    try {\n      setLoading(true);\n      const data = await api.getProducts();\n      setProducts(data);\n    } catch (err) {\n      console.error(err);\n      alert(\"Ошибка загрузки товаров\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const openCreate = () => {\n    setModalMode(\"create\");\n    setEditingProduct(null);\n    setModalOpen(true);\n  };\n\n  const openEdit = (product) => {\n    setModalMode(\"edit\");\n    setEditingProduct(product);\n    setModalOpen(true);\n  };\n\n  const closeModal = () => {\n    setModalOpen(false);\n    setEditingProduct(null);\n  };\n\n  const handleDelete = async (id) => {\n    const ok = window.confirm(\"Удалить товар?\");\n    if (!ok) return;\n    try {\n      await api.deleteProduct(id);\n      setProducts((prev) => prev.filter((p) => p.id !== id));\n    } catch (err) {\n      console.error(err);\n      alert(\"Ошибка удаления товара\");\n    }\n  };\n\n  const handleSubmitModal = async (payload) => {\n    try {\n      if (modalMode === \"create\") {\n        const newProduct = await api.createProduct(payload);\n        setProducts((prev) => [...prev, newProduct]);\n      } else {\n        const updatedProduct = await api.updateProduct(payload.id, payload);\n        setProducts((prev) =>\n          prev.map((p) => (p.id === payload.id ? updatedProduct : p))\n        );\n      }\n      closeModal();\n    } catch (err) {\n      console.error(err);\n      alert(\"Ошибка сохранения товара\");\n    }\n  };\n\n  return (\n    <div className=\"page\">\n      <header className=\"header\">\n        <div className=\"header__inner\">\n          <div className=\"brand\">Магазин электроники</div>\n          <div className=\"header__right\">React</div>\n        </div>\n      </header>\n      <main className=\"main\">\n        <div className=\"container\">\n          <div className=\"toolbar\">\n            <h1 className=\"title\">Товары</h1>\n            <button className=\"btn btn--primary\" onClick={openCreate}>\n              + Создать\n            </button>\n          </div>\n          {loading ? (\n            <div className=\"empty\">Загрузка...</div>\n          ) : (\n            <ProductsList\n              products={products}\n              onEdit={openEdit}\n              onDelete={handleDelete}\n            />\n          )}\n        </div>\n      </main>\n      <footer className=\"footer\">\n        <div className=\"footer__inner\">\n          © {new Date().getFullYear()} Магазин электроники\n        </div>\n      </footer>\n      <ProductModal\n        open={modalOpen}\n        mode={modalMode}\n        initialProduct={editingProduct}\n        onClose={closeModal}\n        onSubmit={handleSubmitModal}\n      />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}